// ================================================================
//         全域變數宣告區 (Global Variables)
// ================================================================

// 宣告全域字串變數，用來儲存 WiFi 連線時所取得的資訊。
// 這些變數因為宣告於函式外，因此所有函式皆可存取。
String MacData;   // 儲存 WiFi 網路卡的 MAC Address（硬體唯一識別碼）
String SSIDData;  // 儲存當前 WiFi 所連接的無線基地台名稱 SSID
String IPData;    // 儲存 router 分配給本裝置的 IP Address（通常是 DHCP 發放）


// ================================================================
//         外部函式庫引用區
// ================================================================

// <String.h> 是 Arduino 內建字串處理函式庫，可讓開發者用 String 類別處理字串資料
#include <String.h>

// 引入 TCP.h，此檔案應為自訂或第三方函式庫
// 內可能包含：WiFi 初始化、TCP連線、MAC/SSID/IP 查詢等功能函式
#include "TCP.h"


// ================================================================
//         自定義函式原型宣告區 (Function Prototype)
//         提前告知編譯器，後方會出現這些函式的定義
// ================================================================

void initSensor();               // 初始化各式感測模組（若有）
void initAll();                  // 負責整體系統初始化，例如序列埠、Relay、OLED等
void INITtWIFI();                // 初始化 WiFi 網路連線、取得 MAC、IP、SSID
void ShowWiFiInformation();      // 將 WiFi 相關資訊顯示於序列監控視窗


// ================================================================
//                      系統初始化區
// ================================================================
void setup()
{
  initAll();       // 呼叫 initAll() 執行整體系統初始化（序列埠、感測器等）
  delay(200);      // 延遲 200 毫秒，避免初始化流程太快導致硬體反應不及
  INITtWIFI();     // 呼叫 WiFi 初始化，並顯示連線資訊 (MAC、SSID、IP)
  Serial.println("Enter Loop()");  // 顯示文字提示已順利進入 loop() 主程式
}


// ================================================================
//      主迴圈 Loop — Arduino 循環執行區塊
// ================================================================
void loop() 
{
  // 此範例 loop 未實作，實際應依案子需求加入：
  // 讀取感測器、傳送資料至伺服器、顯示 OLED、偵測狀態變化等
}



// ================================================================
//            感測器初始化模組
// ================================================================

// 初始化所有感測模組：如溫度、濕度、心跳、氣體、RFID 等
// 現階段為空白，可依系統需求加入初始化程式
void initSensor()
{
  // Example:
  // dht.begin();
  // sensor.init();
}


// ================================================================
//         初始化整體系統
// ================================================================
void initAll()
{
  Serial.begin(9600);  // 啟動序列埠，設定傳輸速率為 9600 bps，以便與PC端監控工具互動
  initSensor();        // 呼叫感測器初始化函式
}


// ================================================================
//         初始化 WiFi 功能，並顯示 MAC/SSID/IP
// ================================================================
void INITtWIFI()
{
  initWiFi();            // 執行 WiFi 連線動作（此函式定義於 TCP.h）
  ShowWiFiInformation(); // 呼叫函式印出 WiFi 相關資訊
}


// ================================================================
//          顯示 WiFi 連線資訊（MAC、SSID、IP）
// ================================================================
void ShowWiFiInformation()
{
  // 取得裝置 MAC Address，並儲存於 MacData
  // MAC 是全球唯一編碼，例如：24:6F:28:A3:87:12
  MacData = GetMAC();

  Serial.println("---MAC Address----");  // 印出標題區塊
  Serial.println(MacData);               // 印出 MAC 地址供檢查
  Serial.println("");                    // 空行，整理版面


  // 顯示目前所連線的 WiFi AP（Access Point）名稱
  Serial.println("---wifi access point----");
  SSIDData = GetSSID();                  // 呼叫函式取得 SSID 名稱
  Serial.println(SSIDData);              // 顯示 SSID


  // 顯示 IP Address
  Serial.println("---Show IP Address----");
  IPData = GetIP();                      // 呼叫函式取得 WiFi 分配 IP
  Serial.println(IPData);                // 印出，例如：192.168.1.105
}
