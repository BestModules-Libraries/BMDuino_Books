// ================================================================
// =============== 全域變數宣告區 (Global Variables) ===============
// ================================================================

// 宣告三個全域變數，用於儲存 WiFi 模組相關資訊
String MacData;   // 儲存目前裝置的 WiFi MAC Address（網路卡的唯一識別碼）
String SSIDData;  // 儲存目前連線的 WiFi 熱點名稱 (SSID)
String IPData;    // 儲存 WiFi 連線後由路由器分配的 IP 位址

// 注意：MacData 為全域變數，可供其他函式或模組使用，不需要重複宣告


// ================================================================
// ================== 引用函式庫 (Include Libraries) ===============
// ================================================================

#include "commlib.h"   // 引用共用模組函式庫，可能包含通訊、延遲、輸出顯示等輔助函式
#include "TCP.h"       // 引用 TCP 通訊函式庫，用於 WiFi 模組初始化、連線與 MAC/SSID/IP 讀取
#include <String.h>    // 引用 Arduino 內建的字串處理函式庫（用於操作 String 類別，如連接、比較等）

// ================================================================
// =================== 自定義函式宣告區 ============================
// ================================================================

// 以下為自訂函式的前置宣告（Forward Declarations）
// 在程式開頭先告知編譯器，稍後這些函式會在程式中被定義

void initSensor();   // 初始化所有感測模組
void initAll();      // 初始化整體系統（包含序列埠與感測器）
void INITtWIFI();    // 初始化 WiFi 模組與網路連線


// ================================================================
// ===================== 系統初始化區 (setup) ======================
// ================================================================

void setup()
{
  initAll();          // 初始化整體系統（包含序列埠啟動與感測模組初始化）
  delay(200);         // 延遲 200 毫秒，確保硬體模組完成啟動，避免初始化失敗
  INITtWIFI();        // 初始化 WiFi 網路，取得 SSID、IP、MAC 等資訊

  //----------------------------
  Serial.println("Enter Loop()"); // 顯示提示訊息，表示已成功完成初始化並進入主迴圈 loop()
}


// ================================================================
// ====================== 主迴圈區 (loop) ==========================
// ================================================================

void loop() 
{   
  Serial.print("Scan WIFI Access Point:\n") ;
  Serial.print(ScanAP()) ;
  delay(2000)  ;       
  // 主迴圈目前為空白，代表此程式主要用於初始化與測試 WiFi 資訊
  // 若未來要擴充，可在此區進行感測器讀取、資料上傳等動作
}


// ================================================================
// ====================== 系統初始化函式區 =========================
// ================================================================

// -------------------- 初始化感測模組 -----------------------------
void initSensor()
{
  // 本系統除 WiFi 模組外，暫無其他感測模組連接
  // 若日後新增感測器（如溫濕度、心率等），可在此區域進行初始化設定
}

// -------------------- 初始化整體系統 -----------------------------
void initAll()
{
  Serial.begin(9600);   // 啟動序列埠 (Serial Monitor)，設定通訊速率為 9600 bps
  initSensor();         // 呼叫感測模組初始化函式
}

// -------------------- 初始化 WiFi 網路 ----------------------------
void INITtWIFI()
{
  initWiFi();   // 呼叫 TCP.h 或 commlib.h 中的 initWiFi() 函式，執行 WiFi 模組啟動與連線
  Serial.println("");
  Serial.println("---wifi access point----");

  // 顯示 MAC Address
  MacData = GetMAC();     // 呼叫庫函式 GetMAC()，取得目前 WiFi 模組的實體 MAC 位址
  Serial.println("---MAC Address----");
  Serial.println(MacData);

  // 取得 WiFi 熱點名稱 (SSID)
  SSIDData = GetSSID();   // 呼叫庫函式 GetSSID()，取得目前連線的 WiFi 名稱
  Serial.println(SSIDData);

  // 顯示 IP 資訊
  Serial.println("---Show IP Address----");
  IPData = GetIP();       // 呼叫庫函式 GetIP()，取得目前 WiFi 模組的 IP 位址
  Serial.println(IPData);
}
